<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Sun Sep 17 2023 21:02:51 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="64f973c54ca94e180261b5cc" data-wf-site="64e6f2c7fa3692d90d1b7012">
<head>
  <meta charset="utf-8">
  <title>Bets 4</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="assets/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="assets/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="assets/css/swer3.webflow.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Poppins:100italic,200,300,regular,500,600,700,800","Nunito:200,300,regular,500,600,700,800,900"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="assets/images/SWER3_FAVI.png" rel="shortcut icon" type="image/x-icon">
  <link href="assets/images/SWER3_FAVI.png" rel="apple-touch-icon">
  <style>
    .swal-icon--info{
      border-color: red;
    }
    .swal-icon--info:after, 
    .swal-icon--info:before{
      background-color: red;
    }
  </style>
</head>
<body class="body">
  <div class="page-wrapper mobile">
    <div class="page-main mob bets">
      <div class="bets-mob-wrapper">
        <div class="bets-heading-wrapper">
          <img onclick="location.href='player-home.html'" src="assets/images/SWER3-PNG.png" loading="lazy" alt="" style="width: 53px; height: 53px;">
          <div class="back-btn-container">
            <img src="assets/images/Vector-7.png" loading="lazy" alt="">
            <div style="padding: .25rem;"></div>
            <a onclick="history.back()" class="back-btn">Back</a>
          </div>
        </div>
        <div class="p-1"></div>
        <div class="bets-typeplay-wrapper">
          <div class="play-head-container tab2">
            <div class="heading-flex">
              <h3 class="head-play m-0">Confirm</h3>
            </div>
          </div>
          <div class="play-wrapper">
            <h1 class="head-type-play text-align-center">Your Bet</h1>
            <div class="selected-bet-grid">
              <div class="circle-big">
                <h2 id="digit1" class="circle-head">X</h2>
              </div>
              <div class="circle-big">
                <h2 id="digit2" class="circle-head">X</h2>
              </div>
              <div class="circle-big">
                <h2 id="digit3" class="circle-head">X</h2>
              </div>
            </div>
            <div class="money-wrapper">
              <h3 class="head-straight"><span id="play">Xxxxx</span> Play  $<span id="amount">XX</span></h3>
              <img id="edit" src="assets/images/edit-document_9533149-1-1.svg" loading="lazy" alt="">
            </div>
            <div class="payment-container">
              <h3 class="payment-head">Payment Method</h3>
              <div class="pay-with-container">
                <h1 class="pay-with-head">Pay with:</h1>
                <div class="balance-container">
                  <h2 id="load_wallet" class="pay-with-head">$XXX.XX</h2>
                  <h5 class="balance">Load balance</h5>
                </div>
              </div>
              <div class="line-v-100"></div>
              <h3 class="payment-head">You’re about to pay</h3>
              <div class="pay-with-container">
                <h1 class="pay-with-head head-2">Amount:</h1>
                <div class="balance-container">
                  <h2 id="pay-amount" class="pay-with-head head-2">$XX.XX</h2>
                </div>
              </div>
              <div class="line-v-100"></div>
              <div class="pay-with-container">
                <h1 class="pay-with-head head-2 green">Total:</h1>
                <div class="balance-container">
                  <h2 id="amount-total" class="pay-with-head head-2 green">$XX.XX</h2>
                </div>
              </div>
              <h5 class="disclaimer">Please make sure the information above is correct. Purchases cannot be reversed.</h5>
            </div>
          </div>
        </div>
        <div class="p-4"></div>
      </div>

      <div class="mobile-navbar _2">
        <div class="picks-flex centered">
          <a id="payBtn" class="btn-secondary w-button">Proceed to pay</a>
        </div>
      </div>

      <!-- modal -->
      <div class="modal-bg bet-mobile">
        <div class="success-msg"><img src="assets/images/checkmark_8832108-1.svg" loading="lazy" alt="">
          <h2 class="succes-head">You successfully added a bet!</h2>
          <div class="standy-message mb-3">Standby for the live draw</div>
          <a href="./player-bets.html" class="btn-secondary w-button">Okay</a>
        </div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=64e6f2c7fa3692d90d1b7012" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="assets/js/webflow.js" type="text/javascript"></script>
  <script src="assets/js/local_routes.js" type="text/javascript"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <script>
    
    $(document).ready(function() {

      // check auth
      var userEmail = localStorage.getItem('user_email');
      var userRole = localStorage.getItem('user_role');

      if (userEmail === null || userRole === null) {
        location.href='player-login.html';
        localStorage.clear();
      }


      
      // get url
      const urlParams = new URLSearchParams(window.location.search);
      const play = urlParams.get('play');
      const betAmount = urlParams.get('betAmount');
      const betNumber = urlParams.get('betNumber');
      var drawId = null;
      var userId = null;
      var loadWallet = null;

      $('#digit1').html(betNumber.charAt(0));
      $('#digit2').html(betNumber.charAt(1));
      $('#digit3').html(betNumber.charAt(2));
      $('#amount').html(betAmount);
      $('#pay-amount').html('$'+betAmount);
      $('#amount-total').html('$'+betAmount);
      $('#play').html(play);



      // get info
      var dataForm = new FormData();
      dataForm.append("email", userEmail);

      var xhr = new XMLHttpRequest();
      xhr.open("POST", PLAYER_API.FETCH_PLAYER_INFO);
      xhr.onload = function(){
        var result = JSON.parse(this.response)
        if(result.message == "success"){
          $('#load_wallet').html('$' + result.load_wallet);
          userId = result.user_id;
          loadWallet = result.load_wallet;
        }else{
          swal("Invalid Request", "Something went wrong." , "error");
          localStorage.clear();
          location.href='player-login.html';
        }
      }
      xhr.send(dataForm); 
      // end of get info


      // incoming draw
      var xhr = new XMLHttpRequest();
      xhr.open("POST", PLAYER_API.FETCH_INCOMING_DRAW_PLAYER);
      xhr.onload = function(){
        var result = JSON.parse(this.response)
        // console.log(result)
        if(result.length != 0){
          drawId = result.draw_id;
        }
      }
      xhr.send(); 
      // end of incoming draw





      // pay btn
      var isClicked = true;
      $('#payBtn').click(function() {
        if(isClicked){
          if(userId != null && loadWallet != null && drawId != null){
            isClicked = false;
            if(parseFloat(loadWallet) < parseFloat(betAmount)) {
              swal("Not Enough Balance", "You don't have enough balance" , "error");
              return;
            }
            var xhr = new XMLHttpRequest();
            xhr.open("POST", PLAYER_API.FETCH_PLACE_BET_PLAYER);
            xhr.onload = function(){
              var result = JSON.parse(this.response)
              if(result.message == 'allow'){
                var dataForm = new FormData();
                dataForm.append("play", play);
                dataForm.append("betAmount", betAmount);
                dataForm.append("betNumber", betNumber);
                dataForm.append("drawId", drawId);
                dataForm.append("userId", userId);
                var xhrPlaceBet = new XMLHttpRequest();
                xhrPlaceBet.open("POST", PLAYER_API.INSERT_PLACE_BET_PLAYER);
                xhrPlaceBet.onload = function(){
                  var result = JSON.parse(this.response)
                  console.log(result)
                  if(result.message == 'success'){
                    $('.bet-mobile').css('display', 'flex');
                  }else if(result.message == 'no load'){
                    swal("Not Enough Balance", "You don't have enough balance" , "error");
                    isClicked = true;
                  }else{
                    swal("This Combination is Sold Out", "Please select different combination" , "info");
                    isClicked = true;
                  }
                }
                xhrPlaceBet.send(dataForm); 
              }else if(result.message == 'not allowed'){
                swal("Betting is Now Closed", "You can't place your bets now, it's already past the cut off time" , "info");
                isClicked = true;
              }else{
                swal(result.message, "Please wait for incoming draw" , "info");
                isClicked = true;
              }
              
            }
            xhr.send(); 
          }        

        }
        
      })
      // end of pay btn

      $('#edit').click(function() {
        window.location.href='player-bets-2.html?play=' + play + '&betAmount=' + betAmount + '&betNumber=' + betNumber;
      })
      
    })
  </script>
</body>
</html>